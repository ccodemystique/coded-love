<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Coded Love</title>
  <style>
    body{
      margin:0; padding:0; background:#111; color:#fff;
      font-family:system-ui,sans-serif;
      display:flex; justify-content:center; align-items:center;
      min-height:100vh;
    }
    #game-container{ text-align:center; padding:14px; }
    #game{ border:2px solid #fff; background:#000; touch-action:none; }

    #controls{
      margin-top:10px;
      display:flex; flex-direction:column;
      align-items:center; gap:6px;
      user-select:none;
    }
    #controls-row{ display:flex; gap:8px; }
    #controls button{
      padding:12px 18px;
      font-size:22px;
      border-radius:10px;
      border:none;
      background:#333;
      color:#fff;
    }
    #controls button:active{ transform:scale(0.96); }

    #final-img{
      display:none;
      max-width:min(420px, 92vw);
      margin-top:12px;
      border-radius:12px;
    }
    #final-text{
      display:none;
      margin-top:10px;
      font-size:18px;
    }
  </style>
</head>
<body>

<div id="game-container">
  <h2 style="margin:0 0 6px;">Coded Love üêç</h2>
  <p style="margin:0 0 10px;">Telefonda butonlarla, PC‚Äôde ok tu≈ülarƒ±yla</p>

  <canvas id="game" width="360" height="360"></canvas>

  <div id="controls">
    <button type="button" onclick="setDir(0,-1)">‚¨ÜÔ∏è</button>
    <div id="controls-row">
      <button type="button" onclick="setDir(-1,0)">‚¨ÖÔ∏è</button>
      <button type="button" onclick="setDir(1,0)">‚û°Ô∏è</button>
    </div>
    <button type="button" onclick="setDir(0,1)">‚¨áÔ∏è</button>
  </div>

  <img id="final-img"
       src="https://drive.google.com/uc?export=view&id=1oeHH-L43JRcoEOqwbTlY3TXg5ZMtz524"
       alt="Surprise" />

  <p id="final-text">Level completed. Bestie unlocked üíò</p>
</div>

<script>
  // ==== AYARLAR ====
  const GRID = 20;
  const TICK_MS = 140;      // daha yava≈ü istersen 160, biraz hƒ±zlansƒ±n dersen 120
  const TARGET_SCORE = 2;   // ‚úÖ 2 elma = foto

  // ==== OYUN STATE ====
  let snakeX = 8, snakeY = 8;
  let velX = 1, velY = 0;
  let trail = [];
  let tail = 5;

  let appleX = 12, appleY = 8;
  let score = 0;
  let timer = null;

  const canvas = document.getElementById("game");
  const ctx = canvas.getContext("2d");
  const tiles = Math.floor(canvas.width / GRID);

  // Global setDir (mobil onclick i√ßin)
  function setDir(x, y){
    // ters y√∂ne d√∂nmeyi engelle
    if (x === -1 && velX === 1) return;
    if (x === 1 && velX === -1) return;
    if (y === -1 && velY === 1) return;
    if (y === 1 && velY === -1) return;
    velX = x; velY = y;
  }
  window.setDir = setDir;

  document.addEventListener("keydown", (e) => {
    if (e.key === "ArrowLeft") setDir(-1,0);
    if (e.key === "ArrowUp") setDir(0,-1);
    if (e.key === "ArrowRight") setDir(1,0);
    if (e.key === "ArrowDown") setDir(0,1);
  });

  function placeApple(){
    appleX = Math.floor(Math.random() * tiles);
    appleY = Math.floor(Math.random() * tiles);
  }

  function finishGame(){
    clearInterval(timer);
    canvas.style.display = "none";
    document.getElementById("controls").style.display = "none";
    document.getElementById("final-img").style.display = "block";
    document.getElementById("final-text").style.display = "block";
  }

  function loop(){
    if (score >= TARGET_SCORE) return;

    // hareket (grid grid, bo≈üluksuz)
    snakeX += velX;
    snakeY += velY;

    // wrap
    if (snakeX < 0) snakeX = tiles - 1;
    if (snakeX >= tiles) snakeX = 0;
    if (snakeY < 0) snakeY = tiles - 1;
    if (snakeY >= tiles) snakeY = 0;

    // temizle
    ctx.fillStyle = "#000";
    ctx.fillRect(0,0,canvas.width,canvas.height);

    // elma (bo≈üluksuz)
    ctx.fillStyle = "#f00";
    ctx.fillRect(appleX*GRID, appleY*GRID, GRID, GRID);

    // yƒ±lan (bo≈üluksuz)
    ctx.fillStyle = "#0f0";
    for (let i=0; i<trail.length; i++){
      ctx.fillRect(trail[i].x*GRID, trail[i].y*GRID, GRID, GRID);

      // kendine √ßarpƒ±nca reset (istersen kapatƒ±rƒ±z)
      if (trail[i].x === snakeX && trail[i].y === snakeY){
        tail = 5; score = 0; trail = [];
      }
    }

    trail.push({x: snakeX, y: snakeY});
    while (trail.length > tail) trail.shift();

    // elma yeme
    if (snakeX === appleX && snakeY === appleY){
      tail++;
      score++;
      placeApple();
      if (score >= TARGET_SCORE) finishGame();
    }
  }

  // ba≈ülat
  timer = setInterval(loop, TICK_MS);
</script>

</body>
</html>
